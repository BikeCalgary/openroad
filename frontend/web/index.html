<!DOCTYPE html>
<html>
  <head>
    <title>Plot your bike path</title>
    <link rel="stylesheet" type="text/css" href="jquery.jqplot.min.css" />

    <style type="text/css">
      html, body {
        width: 600px;
      }

      h1 {
        text-align: center;
      }

      h2 {
        font-size: 1em;
        cursor: pointer;
      }

      .driving {
        color: #cccc00;
      }

      .bicycling {
        color: #00cc00;
      }

      .both {
        color: #77cc00;
      }

      ul#city {
        margin: .5em 0;
        padding: 0;
        list-style: none;
      }

      form.origin-destination a {
        text-decoration: none;
      }

      form.origin-destination a.clicking {
        color: #999;
      }

      ul#city li {
        display: inline-block;
        width: 16.5%;
      }

      ul#city li.selected {
        font-weight: bold;
      }

      div#map {
        width: 100%;
        height: 500px;
      }

      div#data {
        width: 100%;
        height: 20em;
        overflow: auto;
      }

      div#data table {
        border-collapse: collapse;
        border: none;
      }

      div#data th, div#data td {
        text-align: left;
        white-space: nowrap;
        padding: 2px 4px;
        font-size: .75em;
        font-family: Georgia;
      }

      div#data .address {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1><span class="driving">Drive</span> or <span class="bicycling">bike</span>?</h1>
    <form id="origin" class="origin-destination">
      <input type="text" placeholder="example: 99 1st Ave" />
      <input type="submit" value="Set" />
      <div class="status" style="display: none;"></div>
      <div class="error" style="display: none;"></div>
      <a href="#">or click here to choose a point on the map</a>
    </form>
    <form id="destination" class="origin-destination">
      <input type="text" placeholder="example: 12 2nd St" />
      <input type="submit" value="Set" />
      <div class="status" style="display: none;"></div>
      <div class="error" style="display: none;"></div>
      <a href="#">or click here to choose a point on the map</a>
    </form>
    <div id="map"></div>
    <div id="summary"></div>
    <div class="expander">
      <h2>Accidents along these paths, per year</h2>
      <div style="display: none;" id="chart"></div>
    </div>
    <div class="expander">
      <h2>Detailed accident reports along these paths</h2>
      <div style="display: none;" id="data"></div>
    </div>
    <p>Choose your city:</p>
    <ul id="city">
      <li><a href="#vancouver">Vancouver</a></li>
      <li><a href="#calgary">Calgary</a></li>
      <li class="selected"><a href="#toronto">Toronto</a></li>
      <!--<li><a href="#ottawa">Ottawa</a></li>-->
      <li><a href="#montreal">Montreal</a></li>
      <li><a href="#halifax">Halifax</a></li>
    </ul>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.7&sensor=true&key=AIzaSyDWrbWJ46ET44B2Z0UFdqsT3DbsZXKXuqU"></script>
    <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
    <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="excanvas.min.js"></script><![endif]-->
    <script type="text/javascript" src="jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="markerclusterer.js"></script>
    <script type="text/javascript" src="app.js"></script>
    <script type="text/javascript">
      var mapDiv = document.getElementById('map');
      var map = new google.maps.Map(mapDiv, {
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        center: new google.maps.LatLng(0, 0),
        zoom: 1
      });

      var bikeLayer = new google.maps.BicyclingLayer();
      bikeLayer.setMap(map);

      var summaryDiv = document.getElementById('summary');
      var chartDiv = document.getElementById('chart');
      var dataDiv = document.getElementById('data');
      var manager = new Manager(map, undefined, undefined, 'toronto', summaryDiv, chartDiv, dataDiv);

      $('form#origin').address_search_form('origin', manager);
      $('form#destination').address_search_form('destination', manager);

      $('#city a').click(function(e) {
        e.preventDefault();
        e.stopPropagation();
        $a = $(e.target);
        $li = $a.parent();
        $ul = $li.parent();
        $ul.find('li').removeClass('selected');
        $li.addClass('selected');
        manager.setCity($a.attr('href').split(/\#/)[1])
      });

      $('div.expander').expander();
    </script>
  </body>
</html>
